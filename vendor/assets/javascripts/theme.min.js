class Theme{constructor(){this.colors={black:"#14141F",brand:{blue:"#0179A8",indigo:"#346CB0",purple:"#5F4B8B",pink:"#B76BA3",red:"#EA6759",orange:"#EC935E",yellow:"#F7C46C",green:"#A7C796",teal:"#00A28A",cyan:"#3686A0"},gray:{100:"#f6f7f9",200:"#e6e8ed",300:"#d6d8e1",400:"#c6c9d5",500:"#a6abbd",600:"#888c9b",700:"#363642",800:"#222230",900:"#191927"},white:"#ffffff"},this.skins=["default","dark"],this.skin=localStorage.getItem("skin")||"default",this.hasCompactMenu=JSON.parse(localStorage.getItem("hasCompactMenu"))||!1,this.autoInit=localStorage.getItem("autoInit")||!0,$(document).ready(()=>{this.autoInit&&this.init()})}init(){this.placeholderShown(),this.objectFitFallback(),this.tooltips(),this.popovers(),this.nestedDropdown(),this.inputClearable(),this.inputGroup(),this.inputNumber(),this.fileInputBehavior(),this.cardExpansion(),this.modalScrollable(),this.autofocusInputBehaviour(),this.setSkin(this.skin),"dark"===this.skin&&this.invertGrays(),this.asideBackdrop(),this.toggleAside(),this.handleAsideMenu(),this.sidebar(),this.pageExpander(),this.hamburger(),this.publisher(),this.tasksStyle(),this.filterList(),this.radioList(),this.checkboxList(),this.smoothScroll(),this.perfectScrollbar(),this.bootstrapSelect(),this.select2(),this.eventProps(),this.watchMQ(),this.watchIE(),this.browserFlagging(),this.osFlagging(),$(document).trigger("theme:init",this)}objToArray(e){return Object.keys(e).map(t=>e[t])}placeholderShown(){$(document).on("focus blur keyup change",".form-label-group > input",function(){this.classList[this.value?"remove":"add"]("placeholder-shown")}),$(".form-label-group > input").trigger("change")}objectFitFallback(){if(this.isIE()||this.isEdge()){$([".user-avatar img",".tile > img",".figure-attachment > img",".page-cover > .cover-img",".list-group-item-figure > img"].toString()).each(function(){const e=$(this),t=e.prop("src");let s=e.parent();s.is('[data-toggle="dropdown"]')&&(s=s.parent()),t&&(s.css({backgroundImage:`url(${t})`,backgroundSize:"cover",backgroundPosition:"center center"}),(s.hasClass("user-avatar")||s.hasClass("user-avatar"))&&s.css("background-position","top center"),e.css("opacity",0))})}}tooltips(){Popper.Defaults.modifiers.computeStyle.gpuAcceleration=!1,$('[data-toggle="tooltip"]').tooltip()}popovers(){$('[data-toggle="popover"]').popover()}nestedDropdown(){$('.dropdown-menu [data-toggle="dropdown"]').on("click",function(e){e.preventDefault(),e.stopPropagation();const t=$(this),s=t.parent(),a=t.next();s.siblings().find(".dropdown-menu").removeClass("show"),a.toggleClass("show"),t.parents(".nav-item").on("hidden.bs.dropdown",()=>a.removeClass("show"))})}inputClearable(){const e=e=>{const t=!$(e).val();$(e).parent().children(".close").toggleClass("show",!t)};$(".has-clearable > .form-control").each(function(){e(this)}),$(document).on("keyup",".has-clearable > .form-control",function(){e(this)}).on("click",".has-clearable > .close",function(){const t=$(this).parent().children(".form-control");t.val("").focus(),e(t[0]),t.trigger("keyup")})}inputGroup(){$(document).on("focusin focusout",".input-group:not(.input-group-alt) .form-control",function(e){const t=$(this).parent(),s=t.has(".input-group"),a="focusin"===e.type;s&&t.toggleClass("focus",a)})}inputNumber(){$(".custom-number").each(function(){const e=$(this),t=e.children('.form-control[type="number"]'),s=parseFloat(t.attr("min")),a=parseFloat(t.attr("max")),o=parseFloat(t.attr("step"))||1;let i=0;const n=$('<div class="custom-number-controls"></div>'),r=$('<div class="custom-number-btn custom-number-up">+</div>'),l=$('<div class="custom-number-btn custom-number-down">-</div>');n.prepend(r).append(l),e.append(n),r.on("click",function(){const e=parseFloat(t.val())||0;i=e>=a?e:e+o,t.val(i).trigger("change")}),l.on("click",function(){const e=parseFloat(t.val())||0;i=e<=s?e:e-o,t.val(i).trigger("change")})})}fileInputBehavior(){$(".custom-file > .custom-file-label").each(function(){const e=$(this).text();$(this).data("label",e)}),$(document).on("change",".custom-file > .custom-file-input",function(){const e=this.files,t=$(this).next(".custom-file-label"),s=t.data("label");if(t.text(e.length+" files selected"),e.length<=2){let s=[];for(let t=0;t<e.length;t++)s.push(e[t].name);t.text(s.join(", "))}e.length||t.text(s)})}cardExpansion(){$(document).on("show.bs.collapse hide.bs.collapse",".card-expansion-item > .collapse",function(e){const t=$(this).parent(),s="show"===e.type;t.toggleClass("expanded",s)})}modalScrollable(){$(".modal").on("shown.bs.modal",function(){$(this).addClass("has-shown").find(".modal-body").trigger("scroll")}),$(".modal-dialog-scrollable .modal-body, .modal-drawer .modal-body").on("scroll",function(){const e=$(this),t=e[0],s=0===e.scrollTop(),a=t.scrollHeight-e.scrollTop()===e.outerHeight();e.prev().toggleClass("modal-body-scrolled",s),e.next().toggleClass("modal-body-scrolled",a)})}autofocusInputBehaviour(){$(document).on("shown.bs.modal shown.bs.dropdown",".modal, .dropdown",e=>{$(e.target).find('input[autofocus]:first, input[data-autofocus="true"]:first').focus()})}getColors(e){return this.colors[e]}getMutedColor(){return"dark"===this.skin?this.colors.gray[400]:this.colors.gray[600]}getLightColor(){return this.colors.gray[100]}getDarkColor(){return this.colors.gray[900]}setSkin(e){e=this.skins.indexOf(e)<0?"default":e,this.skin!==e&&this.invertGrays(),$("body").removeClass("dark-skin default-skin").addClass(`${e}-skin`),localStorage.setItem("skin",e),this.skin=e}invertGrays(){const e=this.getColors("gray"),t=this.objToArray(e).reverse();let s=0;$.each(e,(e,a)=>{this.colors.gray[e]=t[s],s++})}asideBackdrop(){$(".app").append('<div class="aside-backdrop"/>')}showAsideBackdrop(){return $(".aside-backdrop").addClass("show"),$(".aside-backdrop")}hideAsideBackdrop(){return $(".aside-backdrop").removeClass("show"),$(".aside-backdrop")}showAside(){const e=this.showAsideBackdrop();$(".app-aside").addClass("show"),$('[data-toggle="aside"]').addClass("active"),e.one("click",()=>{this.hideAside()})}hideAside(){this.hideAsideBackdrop(),$(".app-aside").removeClass("show"),$('[data-toggle="aside"]').removeClass("active")}toggleAside(){const e=$('[data-toggle="aside"]');e.on("click",()=>{const t=$(".app-aside").hasClass("show");e.toggleClass("active",!t),t?this.hideAside():this.showAside()})}getMenuOptions(){return{compact:this.hasCompactMenu,hoverable:this.hasCompactMenu}}asideMenu(){let e;window.StackedMenu&&this.isExists("#stacked-menu")&&(this.stackedMenu=new StackedMenu(this.getMenuOptions()),$(".app").toggleClass("has-compact-menu",this.hasCompactMenu),this.watchAside(),$(this.stackedMenu.selector).on("menu:open menu:close",()=>{setTimeout(()=>{window.PerfectScrollbar&&e.update()},300)}),window.PerfectScrollbar&&(e=new PerfectScrollbar(".aside-menu",{suppressScrollX:!0})))}collapseAsideMenu(){void 0!==this.stackedMenu&&(this.stackedMenu.compact(!0).hoverable(!0),this.hasCompactMenu=!0,localStorage.setItem("hasCompactMenu",!0),$(".app").addClass("has-compact-menu")),this.watchAside()}expandAsideMenu(){void 0!==this.stackedMenu&&(this.stackedMenu.compact(!1).hoverable(!1),this.hasCompactMenu=!1,localStorage.setItem("hasCompactMenu",!1),$(".app").removeClass("has-compact-menu")),this.watchAside()}toggleAsideMenu(){1==this.hasCompactMenu?this.expandAsideMenu():this.collapseAsideMenu()}watchAside(){const e=$(".app");void 0!==this.stackedMenu&&(!this.isToggleScreenUp()||e.hasClass("has-fullwidth")?(this.stackedMenu.compact(!1).hoverable(!1),e.removeClass("has-compact-menu")):(this.stackedMenu.compact(this.hasCompactMenu).hoverable(this.hasCompactMenu),e.toggleClass("has-compact-menu",this.hasCompactMenu)))}handleAsideMenu(){$("body").on("click",'[data-toggle="aside-collapse"]',e=>{e.preventDefault(),this.collapseAsideMenu()}).on("click",'[data-toggle="aside-expand"]',e=>{e.preventDefault(),this.expandAsideMenu()}).on("click",'[data-toggle="aside-menu"]',e=>{e.preventDefault(),this.toggleAsideMenu()}),$("html").removeClass("preparing-compact-menu")}showSidebar(e){$(".has-sidebar").addClass("has-sidebar-open"),$(".page-sidebar").trigger({type:"toggle.sidebar",isOpen:!0,relatedTarget:e})}hideSidebar(e){$(".has-sidebar").removeClass("has-sidebar-open"),$(".page-sidebar").trigger({type:"toggle.sidebar",isOpen:!1,relatedTarget:e})}toggleSidebar(e){const t=$(".has-sidebar").hasClass("has-sidebar-open");this.isExists(".has-sidebar")&&t?this.hideSidebar(e):this.isExists(".has-sidebar")&&!t&&this.showSidebar(e)}sidebarBackdrop(){this.isExists(".has-sidebar")&&$(".page").prepend('<div class="sidebar-backdrop" />')}sidebar(){const e=this;this.sidebarBackdrop(),$(document).on("click",'[data-toggle="sidebar"], .sidebar-backdrop',function(t){switch(t.preventDefault(),$(this).data("sidebar")){case"show":e.showSidebar(this);break;case"hide":e.hideSidebar(this);break;default:e.toggleSidebar(this)}})}pageExpander(){$(document).on("click",'[data-toggle="page-expander"]',e=>{e.preventDefault(),$(".page").toggleClass("page-expanded")})}hamburger(){$(document).on("click",".hamburger-toggle",function(){$(this).toggleClass("active")})}publisher(){$(document).on("focusin",".publisher .form-control",function(){const e=$(this).parents(".publisher");$(".publisher").each(function(){!$(this).find(".form-control").val()&&($(this).removeClass("active"),$(this).not(".keep-focus").removeClass("focus"))}),e.addClass("focus active")}).on("click","html",()=>{const e=$(".publisher.active"),t=!e.find(".form-control").val();e.removeClass("active"),t&&e.not(".keep-focus").removeClass("focus")}).on("click",".publisher.active",e=>{e.stopPropagation()})}tasksStyle(){$(document).on("mouseenter mouseleave",".task-header",function(e){const t="mouseenter"===e.type;$(this).parent().toggleClass("hover",t)})}filterList(){$(document).on("keyup","[data-filter]",function(){const e=$(this).data("filter"),t=$(this).val().toLowerCase();$(e).filter(function(){const e=$(this).text().toLowerCase();$(this).toggle(e.indexOf(t)>-1)})})}radioList(){$(document).on("click",'[data-toggle="radiolist"] > *',function(){const e=$(this).parent();e.children().removeClass("active"),$(this).addClass("active"),e.trigger({type:"change",relatedTarget:this})})}checkboxList(){$(document).on("click",'[data-toggle="checkboxlist"] > *',function(){const e=$(this).parent(),t=$(this).hasClass("active");$(this).toggleClass("active",!t),e.trigger({type:"change",relatedTarget:e.children(".active")})})}smoothScroll(){$(document).on("click",'a.smooth-scroll[href^="#"]',function(e){const t=$(this).attr("href"),s=$(t);if(!s.length)return;e.preventDefault();const a=$(".app-header").height()+20,o=s.offset().top-a;$("html, body").animate({scrollTop:o<0?0:o},700)})}perfectScrollbar(){window.PerfectScrollbar&&this.isExists(".perfect-scrollbar")&&$('.perfect-scrollbar:not(".aside-menu")').each(function(){new PerfectScrollbar(this,{suppressScrollX:!0})})}sparkline(){$.fn.sparkline&&$('[data-toggle="sparkline"]').each(function(){const e=$(this).data(),t=e.values||"html";$(this).sparkline(t,e)})}sortable(){window.Sortable&&$('[data-toggle="sortable"]').each(function(){const e=$(this).data();e.animation=e.animation||150,e.filter=e.filter||".ignore-sort",Sortable.create(this,e)})}bootstrapSelect(){$.fn.selectpicker&&($.fn.selectpicker.Constructor.DEFAULTS.style="",$.fn.selectpicker.Constructor.DEFAULTS.styleBase="custom-select",$.fn.selectpicker.Constructor.DEFAULTS.iconBase="mr-1 fa",$.fn.selectpicker.Constructor.DEFAULTS.tickIcon="fa-check font-size-sm mt-2",$('[data-toggle="selectpicker"]').each(function(){$(this).selectpicker().on("loaded.bs.select",function(e){$(e.target).nextAll(".dropdown-menu").prepend('<div class="dropdown-arrow" />')})}))}select2(){$.fn.select2&&($.fn.select2.defaults.set("width","100%"),$('[data-toggle="select2"]').each(function(){let e=$(this).data();e=e.options?e.options:e,$(this).select2(e)}))}touchspin(){$.fn.TouchSpin&&$('[data-toggle="touchspin"]').each(function(){const e=$(this).data(),t={buttondown_class:"btn btn-secondary",buttonup_class:"btn btn-secondary",verticalupclass:"+",verticaldownclass:"-"};$.extend(!0,t,e),$(this).TouchSpin(t)})}quill(){window.Quill&&$('[data-toggle="quill"]').each(function(){const e=$(this).data();null==e.modules&&(e.modules={formula:!0,syntax:!0,toolbar:[[{font:[]},{size:[]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"super"},{script:"sub"}],[{header:[!1,1,2,3,4,5,6]},"blockquote","code-block"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["direction",{align:[]}],["link","image","video","formula"],["clean"]]}),e.theme=e.theme?e.theme:"snow",new Quill(this,e)})}simplemde(){window.SimpleMDE&&$('[data-toggle="simplemde"]').each(function(){const e=$(this).data();e.element=this,new SimpleMDE(e)})}eventProps(){$("body").on("click",".stop-propagation",e=>{e.stopPropagation()}).on("click",".prevent-default",e=>{e.preventDefault()})}watchMQ(){$(window).on("resize",()=>{this.isToggleScreenUp()&&$(".app-aside").hasClass("has-open")&&!$(".app").hasClass("has-fullwidth")&&this.hideAside(),this.watchAside(),$(".app-aside, .page-sidebar").addClass("notransition"),setTimeout(function(){$(".app-aside, .page-sidebar").removeClass("notransition")},1)})}watchIE(){this.isIE()&&$(".metric").each(function(){const e=$(this).height();$(this).height(`${e}px`)})}isOpera(){return!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0}isFirefox(){return"undefined"!=typeof InstallTrigger}isSafari(){return/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString()}isIE(){return!!document.documentMode}isEdge(){return!this.isIE()&&!!window.StyleMedia}isChrome(){return!!window.chrome&&!!window.chrome.webstore}isBlink(){return(this.isChrome()||this.isOpera())&&!!window.CSS}browserFlagging(){this.isOpera()&&$("body").addClass("opera"),this.isFirefox()&&$("body").addClass("firefox"),this.isSafari()&&$("body").addClass("safari"),this.isIE()&&$("body").addClass("ie"),this.isEdge()&&$("body").addClass("edge"),this.isChrome()&&$("body").addClass("chrome"),this.isBlink()&&$("body").addClass("blink")}osFlagging(){-1!=navigator.appVersion.toLowerCase().indexOf("mac")&&$("body").addClass("macos")}isToggleScreenUp(){return window.matchMedia("(min-width: 768px)").matches}isToggleScreenDown(){return window.matchMedia("(max-width: 767.98px)").matches}isExists(e){return $(e).length>0}}export default Theme;
